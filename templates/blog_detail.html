{% extends "base.html" %}
{% load static %}

{% comment %}
    ARCHITECT:
    This block generates a dynamic page title for better SEO.
    Example: "7 Deadly Web Design Mistakes - Lunotech Blog"
{% endcomment %}
{% block title %}
    <span class="lang-en">{{ post.title_en }} - Lunotech Blog</span>
    <span class="lang-fa">{{ post.title_fa }} - وبلاگ لونوتک</span>
{% endblock %}


{% comment %}
    ARCHITECT:
    This block injects page-specific CSS into the <head> of the document.
{% endcomment %}
{% block head_extra %}
  <link rel="stylesheet" href="{% static 'css/blog_detail.css' %}">
{% endblock %}


{% block content %}
{% comment %}
    ARCHITECT:
    The <main> element is the container for our two-column grid layout on desktop.
    It provides the boundary for the sticky share bar.
{% endcomment %}
<main class="blog-detail-page">
    
    <article class="blog-article">
        <header class="article-header">
            {% if post.category %}
            <span class="category-tag">
                <span class="lang-en">{{ post.category.name_en }}</span>
                <span class="lang-fa">{{ post.category.name_fa }}</span>
            </span>
            {% endif %}
            <h1 class="article-title">
                <span class="lang-en">{{ post.title_en }}</span>
                <span class="lang-fa">{{ post.title_fa }}</span>
            </h1>
            <div class="author-meta">
                <span class="author-name">{{ post.creator_name }}</span>
                <span class="meta-separator">•</span>
                <time datetime="{{ post.date|date:"Y-m-d" }}">{{ post.date|date:"F j, Y" }}</time>
            </div>
        </header>

        {% if post.image %}
        {% comment %}
            ARCHITECT:
            The id="hero-image" is the target for our first IntersectionObserver,
            which makes the share bar appear.
        {% endcomment %}
        <figure class="hero-image" id="hero-image">
            <img src="{{ post.image.url }}" alt="{{ post.title_en }}">
        </figure>
        {% endif %}

        <section class="article-content">
            {% comment %}
                ARCHITECT:
                The `|safe` filter is crucial here. It tells Django to render the HTML
                from your TinyMCE editor instead of escaping it for security.
                This is how bold, italics, lists, etc., are displayed correctly.
            {% endcomment %}
            <div class="lang-en">{{ post.description_en|safe }}</div>
            <div class="lang-fa">{{ post.description_fa|safe }}</div>
        </section>
    </article>

    {% comment %}
        ARCHITECT:
        This <aside> is our sticky share bar. The id="social-share-bar" is
        the main target for our JavaScript animations.
    {% endcomment %}
    <aside class="social-share" id="social-share-bar">
        <div class="share-title lang-en">SHARE</div>
        <div class="share-title lang-fa">اشتراک گذاری</div>
        <div class="share-icons-wrapper">
            {% comment %}
                ARCHITECT:
                Using `request.build_absolute_uri` is a Django best practice. It generates
                a full URL (e.g., https://yourdomain.com/blog/your-post) which is
                required by social sharing platforms.
            {% endcomment %}
            <a href="https://www.linkedin.com/shareArticle?mini=true&url={{ request.build_absolute_uri }}" target="_blank" rel="noopener noreferrer" aria-label="Share on LinkedIn" class="share-icon">
                <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-3.06v9.37h3.06v-4.9c0-1.21.37-2.12 1.56-2.12c1.18 0 1.25 1 1.25 2.12v4.9h3.07M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-9.37H5.5v9.37h2.77Z"/></svg>
            </a>
            <a href="https://twitter.com/intent/tweet?url={{ request.build_absolute_uri }}&text={{ post.title_en }}" target="_blank" rel="noopener noreferrer" aria-label="Share on Twitter" class="share-icon">
                <svg viewBox="0 0 24 24"><path fill="currentColor" d="M22.46 6c-.77.35-1.6.58-2.46.69c.88-.53 1.56-1.37 1.88-2.38c-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29c0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15c0 1.49.75 2.81 1.91 3.56c-.71 0-1.37-.22-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07a4.28 4.28 0 0 0 4 2.98a8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21C16 21 20.33 14.5 20.33 8.79c0-.19 0-.37-.01-.56c.84-.6 1.56-1.36 2.14-2.23Z"/></svg>
            </a>
            <button id="copy-link-btn" aria-label="Copy Link" class="share-icon">
                <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19 21H8V7h11m0-2H8a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2m-3-4H4a2 2 0 0 0-2 2v14h2V3h12V1Z"/></svg>
            </button>
        </div>
    </aside>

</main>
{% endblock %}


{% comment %}
    ARCHITECT:
    This block injects page-specific JavaScript just before the closing </body> tag.
{% endcomment %}
{% block body_extra %}
  <script src="{% static 'js/blog_detail.js' %}"></script>
{% endblock %}